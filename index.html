<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>WebXR VR Room</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-physics-system@4.0.1/dist/aframe-physics-system.min.js"></script>
  </head>
  <body>
    <a-scene physics="iterations: 10; gravity: -9.8" xr-mode-ui="enabled: true">
      <!-- Floor (Fixes floating issue) -->
      <a-plane position="0 0 0" rotation="-90 0 0" width="20" height="20" color="#7BC8A4" static-body></a-plane>

      <!-- Table -->
      <a-box position="0 0.75 -3" depth="2" height="0.1" width="2" color="#8B4513" static-body></a-box>

      <!-- Random Objects -->
      <a-entity id="random-objects"></a-entity>
      <script>
        AFRAME.registerComponent('spawn-objects', {
          init: function () {
            let parent = this.el;
            for (let i = 0; i < 15; i++) {
              let entity = document.createElement('a-entity');
              let types = ['box', 'sphere', 'cylinder'];
              let type = types[Math.floor(Math.random() * types.length)];
              let posX = -0.8 + Math.random() * 1.6;
              let posZ = -3.8 + Math.random() * 1.6;
              let posY = 0.9;
              entity.setAttribute('position', {x: posX, y: posY, z: posZ});
              entity.setAttribute('geometry', {primitive: type, height: 0.3, radius: 0.15});
              entity.setAttribute('material', {color: '#' + Math.floor(Math.random() * 16777215).toString(16)});
              entity.setAttribute('dynamic-body', {mass: 1});
              parent.appendChild(entity);
            }
          }
        });
        document.querySelector('#random-objects').setAttribute('spawn-objects', '');
      </script>

      <!-- Camera & Controllers -->
      <a-entity id="cameraRig" position="0 1.6 0">
        <a-entity camera position="0 0 0"></a-entity>
        <a-entity oculus-touch-controls="hand: left" collision-filter="group: controller; collidesWith: objects"></a-entity>
        <a-entity oculus-touch-controls="hand: right" collision-filter="group: controller; collidesWith: objects"></a-entity>
      </a-entity>
    </a-scene>
  </body>
</html>
